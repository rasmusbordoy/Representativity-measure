df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
df
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.45)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.45)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.6)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.55)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.4)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
#############################################
# Data frame with 2 covariates where the
# first has two groups (male, female) and
# the second covariates has three groups
# (rural, urban and suburban)
#############################################
n <- 500
#############################################
# Data frame with 2 covariates where the
# first has two groups (male, female) and
# the second covariates has three groups
# (rural, urban and suburban)
#############################################
n <- 5000
df <- data.frame(matrix(0,nrow=n,ncol=6))
colnames(df) <- c("Response","Male","Female","Rural","Suburban","Urban")
df[,2] <- rbinom(n,1,0.5) #Male
df[,3] <- ifelse(df[,2] == 0,1,0) #Female
df[,4] <- rbinom(n,1,0.2) #rural
df[which(df[,4]==0),5] <- rbinom(length(which(df[,4]==0)),1,0.2) #suburban
df[which(df[,4]==0 & df[,5]==0),6] <- 1
### Simulate a dataset where the response probabilities differ and have interactions
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.45)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.45)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.6)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.55)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.4)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
df$Response <- 0
df[which(df$Male == 1 & df$Rural == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Rural == 1)),1,0.5)
df[which(df$Male == 1 & df$Suburban == 1),1] <-     rbinom(length(which(df$Male == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Male == 1 & df$Urban == 1),1] <-        rbinom(length(which(df$Male == 1 & df$Urban == 1)),1,0.5)
df[which(df$Female == 1 & df$Rural == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Rural == 1)),1,0.5)
df[which(df$Female == 1 & df$Suburban == 1),1] <-   rbinom(length(which(df$Female == 1 & df$Suburban == 1)),1,0.5)
df[which(df$Female == 1 & df$Urban == 1),1] <-      rbinom(length(which(df$Female == 1 & df$Urban == 1)),1,0.5)
library(plyr)
test_df <- matrix(c(ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,sum(Response))[,6],
ddply(df,.(Male,Female,Rural,Suburban,Urban),summarize,length(Response)-sum(Response))[,6]),ncol=6,byrow=TRUE)
chisq.test(test_df)
library(readxl)
library(plyr)
library(tidyverse)
data <- read_excel(path="C:/Users/Rbordoy/Hjerteforeningen/Analyseenhed - Dokumenter/2_Igangsatte projekter/Evalueringer/Hjertemotion/Metode til stikprøve/Data på lokalforeninger.xlsx",sheet="Ark1")
length(unique(data$Kommune))
data <- read_excel(path="C:/Users/Rbordoy/Hjerteforeningen/Analyseenhed - Dokumenter/2_Igangsatte projekter/Evalueringer/Hjertemotion/Metode til stikprøve/Data/Data på lokalforeninger.xlsx",sheet="Ark1")
length(unique(data$Kommune))
nrow(subset(data,antal_hold==0))
data <- subset(data,antal_hold>0)
data <- subset(data,frivillig_tovholder*udd_instruktør*soc_samvær  >0)
dim(data[which(data$antal_hold>1 & data$`Kommunalt samarbejde`==1),])
dim(data[which(data$antal_hold>1 & data$`Kommunalt samarbejde`<1),])
dim(data[which(data$antal_hold==1 & data$`Kommunalt samarbejde`==1),])
dim(data[which(data$antal_hold==1 & data$`Kommunalt samarbejde`<1),])
data <- left_join(data,ddply(data,.(Kommune),summarize,Kommunalt_samarbejde_generelt = prod(`Kommunalt samarbejde`)))
data <- left_join(data,ddply(data,.(Kommune),summarize, sum_antal_hold = sum(antal_hold)))
data$Group <- NA
data[which(data$sum_antal_hold>1 & data$Kommunalt_samarbejde_generelt==1),"Group"] <- "G1"
data[which(data$sum_antal_hold==1 & data$Kommunalt_samarbejde_generelt==1),"Group"] <- "G2"
data[which(data$Kommunalt_samarbejde_generelt<1),"Group"] <- "G3"
data <- distinct(data[,c("Kommune","antal_indbyggere","Group")])
data <- left_join(data,ddply(data,.(Group),summarize,samp.size=round(20*length(Kommune)/nrow(data),0)))
data <- data.frame(data)
data$Kommune[data$Kommune %in% c("Nordfyn","Vesthimmerland")] <- c("Nordfyns","Vesthimmerlands")
data$Sample <- 0
data[which(data$Kommune %in% sample(data[which(data$Group == "G3" & data$Sample == 0),"Kommune"],
size=unique(data[which(data$Group == "G3" & data$Sample == 0),"samp.size"]))),"Sample"] <- 1
data[which(data$Kommune %in% sample(data[which(data$Group == "G2" & data$Sample == 0),"Kommune"],
size=unique(data[which(data$Group == "G2" & data$Sample == 0),"samp.size"]))),"Sample"] <- 1
data[which(data$Kommune %in% sample(data[which(data$Group == "G1" & data$Sample == 0),"Kommune"],
size=unique(data[which(data$Group == "G1" & data$Sample == 0),"samp.size"]))),"Sample"] <- 1
unique(data[which(data$Sample == 1),"Kommune"])
data
7+2+11
data <- read_excel(path="C:/Users/Rbordoy/Hjerteforeningen/Analyseenhed - Dokumenter/2_Igangsatte projekter/Evalueringer/Hjertemotion/Metode til stikprøve/Data/Data på lokalforeninger.xlsx",sheet="Ark1")
length(unique(data$Kommune))
nrow(subset(data,antal_hold==0))
data <- subset(data,antal_hold>0)
nrow(subset(data,frivillig_tovholder*udd_instruktør*soc_samvær ==0))
data <- subset(data,frivillig_tovholder*udd_instruktør*soc_samvær  >0)
dim(data[which(data$antal_hold>1 & data$`Kommunalt samarbejde`==1),])
dim(data[which(data$antal_hold>1 & data$`Kommunalt samarbejde`<1),])
dim(data[which(data$antal_hold==1 & data$`Kommunalt samarbejde`==1),])
dim(data[which(data$antal_hold==1 & data$`Kommunalt samarbejde`<1),])
data <- left_join(data,ddply(data,.(Kommune),summarize,Kommunalt_samarbejde_generelt = prod(`Kommunalt samarbejde`)))
data <- left_join(data,ddply(data,.(Kommune),summarize, sum_antal_hold = sum(antal_hold)))
data
data$Group <- NA
data[which(data$sum_antal_hold>1 & data$Kommunalt_samarbejde_generelt==1),"Group"] <- "G1"
data[which(data$sum_antal_hold==1 & data$Kommunalt_samarbejde_generelt==1),"Group"] <- "G2"
data[which(data$Kommunalt_samarbejde_generelt<1),"Group"] <- "G3"
data <- distinct(data[,c("Kommune","antal_indbyggere","Group")])
data <- left_join(data,ddply(data,.(Group),summarize,samp.size=round(20*length(Kommune)/nrow(data),0)))
data <- data.frame(data)
data$Kommune[data$Kommune %in% c("Nordfyn","Vesthimmerland")] <- c("Nordfyns","Vesthimmerlands")
data
data[which(data$Kommune %in% sample(data[which(data$Group == "G3" & data$Sample == 0),"Kommune"],
size=unique(data[which(data$Group == "G3" & data$Sample == 0),"samp.size"]))),"Sample"] <- 1
data$Sample <- 0
data[which(data$Kommune %in% sample(data[which(data$Group == "G3" & data$Sample == 0),"Kommune"],
size=unique(data[which(data$Group == "G3" & data$Sample == 0),"samp.size"]))),"Sample"] <- 1
data[which(data$Kommune %in% sample(data[which(data$Group == "G2" & data$Sample == 0),"Kommune"],
size=unique(data[which(data$Group == "G2" & data$Sample == 0),"samp.size"]))),"Sample"] <- 1
data[which(data$Kommune %in% sample(data[which(data$Group == "G1" & data$Sample == 0),"Kommune"],
size=unique(data[which(data$Group == "G1" & data$Sample == 0),"samp.size"]))),"Sample"] <- 1
unique(data[which(data$Sample == 1),"Kommune"])
data <- read_excel(path="C:/Users/Rbordoy/Hjerteforeningen/Analyseenhed - Dokumenter/2_Igangsatte projekter/Evalueringer/Hjertemotion/Metode til stikprøve/Data/Data på lokalforeninger.xlsx",sheet="Ark1")
data
data <- subset(data,antal_hold>0)
nrow(subset(data,frivillig_tovholder*udd_instruktør*soc_samvær ==0))
data <- subset(data,frivillig_tovholder*udd_instruktør*soc_samvær  >0)
